# kafka-test
kafka-performance

<hr>

## 실시간 라이브 방송으로 가정

1. 유저는 실시간 방송에 대해 좋아요를 누를 수 있다.
   - 한 유저는 좋아요 100개까지 누를 수 있다. 최대 100개 (광클)
2. 특정 기간동안 유저들의 좋아요 개수가 증가하면 요청을 보내지 못하도록 할 수 있다.
    > 서버에 과부하 요청을 막기 위함.
3. 방송에 대한 좋아요 개수를 평균 5분동안 집계한다.

<hr>

### 고려 사항

1. 디비가 필요한가?
   - 서비스가 끝나면 좋아요 집계정도만 있으면 될 것 같고 데이터의 이동은 디비에 접근을 하지 않아도 될 것 같다.
2. 레디스? 
   - 레디스가 괜찮다고 판단됨, 빠르게 접근이 가능하고, 순차적으로 처리가 보장하기 때문에 괜찮을 것 같다.
3. 카프카
    - 주된 목적
    - 좋아야 개수가 유실이 되어도 괜찮은가? 
      - acks = -1
      - acks = 1
    - 컨슘쪽에스 스트림즈를 사용하여 구현 (추후)
    - 가령 좋아요가 3만개를 limit으로 생각하고 코드를 짠다면, 프로듀싱할 때 막는것이 좋은가, 아니면 컨슘에서 ?
      - 프로듀싱에서 체크하여 안 보내는것이 나은듯
<hr>

### 실험방법
k6를 이용한 성능 테스트를 진행한다.
api 요청을 통해 진행

프로듀서와 컨슈머를 따로 구성해야할까?

카프카 구성
1. 브로커 3
2. topic partition 3 replica 2
   - 토픽을 어떻게 구성하는것이 맞나?
     - 방송을 여러개 할 수 있으니, 토픽은 방송별로 생성(like)
   - consumer 3


